#!/usr/bin/env ruby

PROJECT_ROOT = File.dirname(__FILE__) + "/../"
LIBRARY_PATH = PROJECT_ROOT + "lib/"

$: << LIBRARY_PATH unless $:.include?(LIBRARY_PATH)

INDICES = %w{mainstream detailed government}

require "logging"
require "search_config"
require "slop"
require "bulk_loader"

Slop.parse(help: true) do
  banner %Q{Usage: #{File.basename(__FILE__)} {#{INDICES.join("|")}}

Bulk loads data from stdin to the specified index. Loading is done in an
unconnected index alias and on completion of the index load the alias is
switched over.

}
  run do |opts, args|
    raise("Please specify exactly one index") unless args.size == 1
    BulkLoader.new(SearchConfig.new, args.first, logger: Logger.new(STDERR)).load_from($stdin)
  end
end

